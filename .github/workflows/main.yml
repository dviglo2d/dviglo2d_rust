name: Main

on:
  push:
  workflow_dispatch:

jobs:
  linux:
    runs-on: ubuntu-latest

    name: üêß

    steps:
    - name: –°–∫–∞—á–∏–≤–∞–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
      uses: actions/checkout@v4
      with:
        fetch-depth: 0
        path: repo

    - name: –ö–æ–º–ø–∏–ª–∏—Ä—É–µ–º
      shell: bash
      run: |
        # -C dir —Ç—Ä–µ–±—É–µ—Ç +nightly -Z unstable-options
        cargo +nightly -Z unstable-options -C repo build --all-targets

    - name: –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã
      shell: bash
      run: |
        # -C dir —Ç—Ä–µ–±—É–µ—Ç +nightly -Z unstable-options
        cargo +nightly -Z unstable-options -C repo test --verbose

  windows:
    runs-on: windows-latest

    name: üî≤

    steps:
    - name: –°–∫–∞—á–∏–≤–∞–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
      uses: actions/checkout@v4
      with:
        fetch-depth: 0
        path: repo

    - name: –ö–æ–º–ø–∏–ª–∏—Ä—É–µ–º
      shell: bash
      run: |
        # -C dir —Ç—Ä–µ–±—É–µ—Ç +nightly -Z unstable-options
        cargo +nightly -Z unstable-options -C repo build --all-targets

    - name: –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã
      shell: bash
      run: |
        # -C dir —Ç—Ä–µ–±—É–µ—Ç +nightly -Z unstable-options
        cargo +nightly -Z unstable-options -C repo test --verbose
